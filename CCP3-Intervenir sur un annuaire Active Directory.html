<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intervenir sur un annuaire Active Directory - TAI 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background: #F5F5F7;
            color: #1a1a1a;
            line-height: 1.7;
        }

        nav {
            background: white;
            padding: 1.2rem 4rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 900;
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, #3B5BDB, #3DDAB4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .back-btn {
            padding: 0.7rem 1.5rem;
            background: linear-gradient(135deg, #3B5BDB, #3DDAB4);
            color: white;
            border: none;
            border-radius: 20px;
            font-family: 'Manrope', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(59, 91, 219, 0.3);
        }

        .hero {
            background: linear-gradient(135deg, #3B5BDB, #3DDAB4);
            color: white;
            padding: 4rem 4rem 3rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero .badge {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 4rem;
        }

        .course-content {
            background: white;
            border-radius: 30px;
            padding: 3rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.06);
        }

        .section {
            margin-bottom: 3rem;
        }

        .section h2 {
            font-size: 1.8rem;
            color: #3B5BDB;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 3px solid #3DDAB4;
        }

        .section h3 {
            font-size: 1.3rem;
            color: #1a1a1a;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .section p {
            margin-bottom: 1rem;
            color: #444;
            font-size: 1.05rem;
        }

        .section ul, .section ol {
            margin-left: 2rem;
            margin-bottom: 1.5rem;
        }

        .section li {
            margin-bottom: 0.8rem;
            color: #444;
        }

        .highlight-box {
            background: #f0f7ff;
            border-left: 4px solid #3B5BDB;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 10px;
        }

        .highlight-box.success {
            background: #e8f5e9;
            border-left-color: #3DDAB4;
        }

        .highlight-box.warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }

        .highlight-box.danger {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .example-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            padding: 1.5rem;
            border-radius: 15px;
            margin: 1.5rem 0;
        }

        .example-box h4 {
            color: #3B5BDB;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border: 1px solid #e0e0e0;
        }

        th {
            background: linear-gradient(135deg, #3B5BDB, #3DDAB4);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .key-point {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 1.5rem;
            border-radius: 15px;
            border-left: 4px solid #3B5BDB;
        }

        .key-point h4 {
            color: #3B5BDB;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .process-steps {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .process-step {
            display: flex;
            gap: 1.5rem;
            align-items: start;
        }

        .step-number {
            min-width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #3B5BDB, #3DDAB4);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .step-content {
            flex: 1;
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 15px;
        }

        .step-content h4 {
            color: #3B5BDB;
            margin-bottom: 0.8rem;
        }

        .quiz-section {
            background: linear-gradient(135deg, #f0f7ff, #e8f5e9);
            padding: 2rem;
            border-radius: 20px;
            margin-top: 3rem;
        }

        .quiz-section h3 {
            color: #3B5BDB;
            margin-bottom: 1.5rem;
        }

        .command-box {
            background: #1a1a1a;
            color: #3DDAB4;
            padding: 1.5rem;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 1.5rem 0;
            overflow-x: auto;
        }

        .command-box code {
            color: #3DDAB4;
        }

        footer {
            background: #1a1a1a;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            nav, .hero, .container {
                padding-left: 2rem;
                padding-right: 2rem;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .course-content {
                padding: 2rem;
            }

            .key-points {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo-container">
            <div class="logo">TAI 2025</div>
        </div>
        <a href="index.html" class="back-btn">‚Üê Retour au programme</a>
    </nav>

    <div class="hero">
        <div class="badge">CCP 3 - Intervenir sur les √âl√©ments de l'Infrastructure</div>
        <h1>Intervenir sur un annuaire Active Directory</h1>
    </div>

    <div class="container">
        <div class="course-content">
            
            <!-- Introduction -->
            <div class="section">
                <h2>üîê Introduction</h2>
                <p>Active Directory (AD) est le service d'annuaire de Microsoft qui centralise la gestion des utilisateurs, groupes, ordinateurs et ressources d'un r√©seau Windows. L'intervention sur AD est une comp√©tence cl√© pour administrer efficacement un domaine Windows.</p>
                
                <div class="highlight-box">
                    <strong>Objectif principal :</strong> G√©rer les comptes utilisateurs, organiser les ressources, d√©ployer des strat√©gies et s√©curiser l'acc√®s aux ressources de l'entreprise de mani√®re centralis√©e.
                </div>
            </div>

            <!-- Partie 1 -->
            <div class="section">
                <h2>üë§ 1. Gestion des Utilisateurs</h2>
                
                <h3>Cr√©er un utilisateur</h3>

                <div class="key-points">
                    <div class="key-point">
                        <h4>Via Interface Graphique</h4>
                        <p>Outils d'administration Windows ‚Üí Utilisateurs et ordinateurs Active Directory ‚Üí Clic droit sur l'OU ‚Üí Nouveau ‚Üí Utilisateur</p>
                    </div>
                    <div class="key-point">
                        <h4>Via PowerShell</h4>
                        <p>M√©thode rapide et automatisable pour cr√©er des comptes en masse ou via scripts.</p>
                    </div>
                </div>

                <div class="example-box">
                    <h4>üí° Cr√©ation d'utilisateur en PowerShell</h4>
                    <div class="command-box">
                        <code>
# Cr√©er un nouvel utilisateur<br>
New-ADUser -Name "Jean Dupont" `<br>
&nbsp;&nbsp;-GivenName "Jean" `<br>
&nbsp;&nbsp;-Surname "Dupont" `<br>
&nbsp;&nbsp;-SamAccountName "jdupont" `<br>
&nbsp;&nbsp;-UserPrincipalName "jdupont@entreprise.local" `<br>
&nbsp;&nbsp;-Path "OU=Utilisateurs,DC=entreprise,DC=local" `<br>
&nbsp;&nbsp;-AccountPassword (ConvertTo-SecureString "P@ssw0rd123!" -AsPlainText -Force) `<br>
&nbsp;&nbsp;-Enabled $true `<br>
&nbsp;&nbsp;-ChangePasswordAtLogon $true
                        </code>
                    </div>
                </div>

                <h3>Op√©rations courantes sur les utilisateurs</h3>
                <table>
                    <tr>
                        <th>Op√©ration</th>
                        <th>Commande PowerShell</th>
                        <th>Usage</th>
                    </tr>
                    <tr>
                        <td><strong>D√©sactiver un compte</strong></td>
                        <td>Disable-ADAccount -Identity jdupont</td>
                        <td>D√©part temporaire, suspension</td>
                    </tr>
                    <tr>
                        <td><strong>R√©activer un compte</strong></td>
                        <td>Enable-ADAccount -Identity jdupont</td>
                        <td>Retour d'un utilisateur</td>
                    </tr>
                    <tr>
                        <td><strong>R√©initialiser mot de passe</strong></td>
                        <td>Set-ADAccountPassword -Identity jdupont -Reset</td>
                        <td>Mot de passe oubli√©</td>
                    </tr>
                    <tr>
                        <td><strong>D√©placer un utilisateur</strong></td>
                        <td>Move-ADObject -Identity "CN=..." -TargetPath "OU=..."</td>
                        <td>Changement de service</td>
                    </tr>
                    <tr>
                        <td><strong>Supprimer un utilisateur</strong></td>
                        <td>Remove-ADUser -Identity jdupont</td>
                        <td>D√©part d√©finitif</td>
                    </tr>
                </table>

                <div class="example-box">
                    <h4>üí° Modifier les propri√©t√©s d'un utilisateur</h4>
                    <div class="command-box">
                        <code>
# Modifier le num√©ro de t√©l√©phone<br>
Set-ADUser -Identity jdupont -OfficePhone "01.23.45.67.89"<br><br>

# Modifier le service<br>
Set-ADUser -Identity jdupont -Department "Comptabilit√©"<br><br>

# Ajouter une description<br>
Set-ADUser -Identity jdupont -Description "Responsable comptable"<br><br>

# D√©finir une date d'expiration de compte<br>
Set-ADAccountExpiration -Identity jdupont -DateTime "31/12/2025"
                        </code>
                    </div>
                </div>

                <div class="highlight-box warning">
                    <strong>‚ö†Ô∏è Bonnes pratiques :</strong>
                    <ul>
                        <li>Utiliser une convention de nommage coh√©rente (ex: prenom.nom)</li>
                        <li>Forcer le changement de mot de passe √† la premi√®re connexion</li>
                        <li>D√©sactiver les comptes plut√¥t que les supprimer imm√©diatement</li>
                        <li>Documenter les op√©rations importantes dans un journal</li>
                    </ul>
                </div>
            </div>

            <!-- Partie 2 -->
            <div class="section">
                <h2>üë• 2. Gestion des Groupes</h2>
                
                <h3>Types de groupes Active Directory</h3>

                <table>
                    <tr>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Usage</th>
                    </tr>
                    <tr>
                        <td><strong>Groupe de s√©curit√©</strong></td>
                        <td>Permet d'attribuer des permissions</td>
                        <td>Acc√®s aux ressources (dossiers, imprimantes)</td>
                    </tr>
                    <tr>
                        <td><strong>Groupe de distribution</strong></td>
                        <td>Listes de diffusion e-mail uniquement</td>
                        <td>Envoi d'emails group√©s (Exchange)</td>
                    </tr>
                </table>

                <h3>Port√©es des groupes</h3>
                <div class="key-points">
                    <div class="key-point">
                        <h4>Global</h4>
                        <p>Membres du m√™me domaine. Utilis√© pour regrouper des utilisateurs d'un m√™me domaine.</p>
                    </div>
                    <div class="key-point">
                        <h4>Domaine local</h4>
                        <p>Assigne des permissions sur les ressources locales. Peut contenir des membres de n'importe quel domaine.</p>
                    </div>
                    <div class="key-point">
                        <h4>Universel</h4>
                        <p>Membres de n'importe quel domaine de la for√™t. Utilis√© pour les grandes infrastructures multi-domaines.</p>
                    </div>
                </div>

                <h3>Cr√©er et g√©rer des groupes</h3>
                <div class="example-box">
                    <h4>üí° Cr√©ation et gestion de groupes</h4>
                    <div class="command-box">
                        <code>
# Cr√©er un groupe de s√©curit√©<br>
New-ADGroup -Name "GRP_Comptabilite" `<br>
&nbsp;&nbsp;-GroupScope Global `<br>
&nbsp;&nbsp;-GroupCategory Security `<br>
&nbsp;&nbsp;-Path "OU=Groupes,DC=entreprise,DC=local" `<br>
&nbsp;&nbsp;-Description "Groupe pour le service comptabilit√©"<br><br>

# Ajouter un membre au groupe<br>
Add-ADGroupMember -Identity "GRP_Comptabilite" -Members jdupont<br><br>

# Ajouter plusieurs membres<br>
Add-ADGroupMember -Identity "GRP_Comptabilite" -Members jdupont,mdoe,asmith<br><br>

# Retirer un membre<br>
Remove-ADGroupMember -Identity "GRP_Comptabilite" -Members jdupont<br><br>

# Lister les membres d'un groupe<br>
Get-ADGroupMember -Identity "GRP_Comptabilite"
                        </code>
                    </div>
                </div>

                <div class="highlight-box">
                    <strong>üí° Strat√©gie AGDLP :</strong>
                    <p>Bonne pratique pour organiser les groupes et permissions :</p>
                    <ul>
                        <li><strong>A</strong>ccounts (Comptes) ‚Üí Ajouter les utilisateurs</li>
                        <li><strong>G</strong>lobal groups (Groupes globaux) ‚Üí Regrouper par fonction/service</li>
                        <li><strong>D</strong>omain Local groups (Groupes locaux de domaine) ‚Üí D√©finir par ressource</li>
                        <li><strong>P</strong>ermissions ‚Üí Attribuer les droits aux groupes locaux</li>
                    </ul>
                </div>

                <h3>Groupes sp√©ciaux int√©gr√©s</h3>
                <table>
                    <tr>
                        <th>Groupe</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><strong>Domain Admins</strong></td>
                        <td>Administrateurs du domaine, droits complets</td>
                    </tr>
                    <tr>
                        <td><strong>Domain Users</strong></td>
                        <td>Tous les utilisateurs du domaine</td>
                    </tr>
                    <tr>
                        <td><strong>Domain Computers</strong></td>
                        <td>Tous les ordinateurs joints au domaine</td>
                    </tr>
                    <tr>
                        <td><strong>Enterprise Admins</strong></td>
                        <td>Administrateurs de toute la for√™t AD</td>
                    </tr>
                </table>
            </div>

            <!-- Partie 3 -->
            <div class="section">
                <h2>‚öôÔ∏è 3. Strat√©gies de Groupe (GPO)</h2>
                
                <h3>Qu'est-ce qu'une GPO ?</h3>
                <p>Les <strong>Group Policy Objects</strong> (Objets de strat√©gie de groupe) permettent de configurer et d√©ployer automatiquement des param√®tres sur les utilisateurs et ordinateurs du domaine. C'est l'outil central pour administrer un parc Windows.</p>

                <div class="key-points">
                    <div class="key-point">
                        <h4>Configuration ordinateur</h4>
                        <p>S'applique aux machines (s√©curit√©, logiciels, scripts de d√©marrage)</p>
                    </div>
                    <div class="key-point">
                        <h4>Configuration utilisateur</h4>
                        <p>S'applique aux comptes (bureau, pr√©f√©rences, lecteurs mapp√©s)</p>
                    </div>
                </div>

                <h3>Cr√©er et lier une GPO</h3>

                <div class="process-steps">
                    <div class="process-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Ouvrir la console de gestion</h4>
                            <p>Ex√©cuter <strong>gpmc.msc</strong> (Group Policy Management Console)</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Cr√©er la GPO</h4>
                            <p>Clic droit sur l'OU cible ‚Üí <strong>Cr√©er un objet GPO dans ce domaine et le lier ici</strong></p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Nommer la GPO</h4>
                            <p>Utiliser un nom descriptif (ex: "GPO_Securite_Postes_Comptabilite")</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Modifier la GPO</h4>
                            <p>Clic droit ‚Üí <strong>Modifier</strong> pour acc√©der √† l'√©diteur et configurer les param√®tres</p>
                        </div>
                    </div>
                </div>

                <h3>Exemples de GPO courantes</h3>
                <table>
                    <tr>
                        <th>Objectif</th>
                        <th>Emplacement</th>
                        <th>Param√®tre</th>
                    </tr>
                    <tr>
                        <td><strong>D√©ployer un logiciel</strong></td>
                        <td>Config ordinateur ‚Üí Strat√©gies ‚Üí Param√®tres du logiciel</td>
                        <td>Installation de logiciel (fichier .msi)</td>
                    </tr>
                    <tr>
                        <td><strong>D√©finir un fond d'√©cran</strong></td>
                        <td>Config utilisateur ‚Üí Strat√©gies ‚Üí Mod√®les admin ‚Üí Bureau</td>
                        <td>Papier peint du Bureau</td>
                    </tr>
                    <tr>
                        <td><strong>Mapper des lecteurs r√©seau</strong></td>
                        <td>Config utilisateur ‚Üí Pr√©f√©rences ‚Üí Param√®tres Windows</td>
                        <td>Mappages de lecteurs</td>
                    </tr>
                    <tr>
                        <td><strong>Strat√©gie de mot de passe</strong></td>
                        <td>Config ordinateur ‚Üí Strat√©gies ‚Üí Param√®tres de s√©curit√©</td>
                        <td>Strat√©gie de compte</td>
                    </tr>
                    <tr>
                        <td><strong>D√©sactiver l'USB</strong></td>
                        <td>Config ordinateur ‚Üí Strat√©gies ‚Üí Mod√®les admin ‚Üí Syst√®me</td>
                        <td>Acc√®s au stockage amovible</td>
                    </tr>
                </table>

                <div class="example-box">
                    <h4>üí° Mapper un lecteur r√©seau via GPO</h4>
                    <div class="command-box">
                        <code>
# Navigation dans l'√©diteur GPO<br>
Configuration utilisateur<br>
‚îî‚îÄ Pr√©f√©rences<br>
&nbsp;&nbsp;&nbsp;‚îî‚îÄ Param√®tres Windows<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ Mappages de lecteurs<br><br>

# Clic droit ‚Üí Nouveau ‚Üí Lecteur mapp√©<br>
Action : Cr√©er<br>
Emplacement : \\serveur\partage<br>
Reconnecter : Activ√©<br>
Lettre : P: (par exemple)<br>
√âtiquette : Partage Documents
                        </code>
                    </div>
                </div>

                <h3>Commandes GPO essentielles</h3>
                <div class="example-box">
                    <h4>üí° Gestion des GPO en ligne de commande</h4>
                    <div class="command-box">
                        <code>
# Forcer l'application imm√©diate des GPO<br>
gpupdate /force<br><br>

# Voir les GPO appliqu√©es √† l'utilisateur/ordinateur<br>
gpresult /r<br><br>

# G√©n√©rer un rapport HTML d√©taill√©<br>
gpresult /h C:\rapport_gpo.html<br><br>

# Afficher les GPO appliqu√©es pour un utilisateur sp√©cifique<br>
gpresult /user jdupont /r
                        </code>
                    </div>
                </div>

                <div class="highlight-box warning">
                    <strong>‚ö†Ô∏è Ordre d'application des GPO :</strong>
                    <ol>
                        <li><strong>Local</strong> - Strat√©gie locale de l'ordinateur</li>
                        <li><strong>Site</strong> - GPO au niveau du site AD</li>
                        <li><strong>Domaine</strong> - GPO au niveau du domaine</li>
                        <li><strong>OU</strong> - GPO sur les unit√©s d'organisation (priorit√© la plus haute)</li>
                    </ol>
                    <p>Les GPO des enfants remplacent celles des parents, sauf si "Appliqu√©" est activ√©.</p>
                </div>
            </div>

            <!-- Partie 4 -->
            <div class="section">
                <h2>üé≠ 4. R√¥les FSMO et D√©l√©gation</h2>
                
                <h3>Les 5 r√¥les FSMO (Flexible Single Master Operations)</h3>
                <p>Certaines op√©rations AD ne peuvent √™tre effectu√©es que par un seul contr√¥leur de domaine √† la fois. Ces r√¥les critiques doivent √™tre correctement r√©partis.</p>

                <div class="key-points">
                    <div class="key-point">
                        <h4>Niveau For√™t</h4>
                        <p><strong>Contr√¥leur de sch√©ma :</strong> G√®re les modifications du sch√©ma AD</p>
                        <p><strong>Ma√Ætre d'attribution de noms :</strong> G√®re l'ajout/suppression de domaines</p>
                    </div>
                    <div class="key-point">
                        <h4>Niveau Domaine</h4>
                        <p><strong>√âmulateur PDC :</strong> Sync horaire, authentification prioritaire, mots de passe</p>
                        <p><strong>Ma√Ætre RID :</strong> Distribue les pools d'identifiants uniques</p>
                        <p><strong>Ma√Ætre d'infrastructure :</strong> Maintient les r√©f√©rences entre domaines</p>
                    </div>
                </div>

                <div class="example-box">
                    <h4>üí° Identifier les d√©tenteurs de r√¥les FSMO</h4>
                    <div class="command-box">
                        <code>
# Voir tous les r√¥les FSMO<br>
netdom query fsmo<br><br>

# Via PowerShell (plus d√©taill√©)<br>
Get-ADDomain | Select-Object PDCEmulator, RIDMaster, InfrastructureMaster<br>
Get-ADForest | Select-Object SchemaMaster, DomainNamingMaster
                        </code>
                    </div>
                </div>

                <h3>D√©l√©gation de contr√¥le</h3>
                <p>La d√©l√©gation permet d'accorder des droits administratifs limit√©s sur une OU sans donner les privil√®ges d'administrateur du domaine. Parfait pour distribuer les t√¢ches au support technique.</p>

                <div class="process-steps">
                    <div class="process-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>S√©lectionner l'OU</h4>
                            <p>Dans "Utilisateurs et ordinateurs AD", clic droit sur l'OU ‚Üí <strong>D√©l√©guer le contr√¥le</strong></p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Choisir les utilisateurs/groupes</h4>
                            <p>S√©lectionner le groupe ou utilisateur qui recevra les droits (ex: GRP_Helpdesk)</p>
<div class="process-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Choisir les utilisateurs/groupes</h4>
                            <p>S√©lectionner le groupe ou utilisateur qui recevra les droits (ex: GRP_Helpdesk)</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>D√©finir les t√¢ches</h4>
                            <p>Choisir les t√¢ches courantes √† d√©l√©guer ou cr√©er une t√¢che personnalis√©e</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Valider</h4>
                            <p>V√©rifier le r√©sum√© et terminer l'assistant de d√©l√©gation</p>
                        </div>
                    </div>
                </div>

                <div class="example-box">
                    <h4>üí° T√¢ches courantes √† d√©l√©guer</h4>
                    <ul>
                        <li>R√©initialiser les mots de passe et forcer le changement</li>
                        <li>Cr√©er, supprimer et g√©rer les comptes utilisateurs</li>
                        <li>Modifier l'appartenance d'un groupe</li>
                        <li>G√©rer les strat√©gies de groupe</li>
                        <li>G√©rer les comptes ordinateurs</li>
                    </ul>
                </div>

                <div class="highlight-box warning">
                    <strong>‚ö†Ô∏è Bonnes pratiques de d√©l√©gation :</strong>
                    <ul>
                        <li>D√©l√©guer √† des groupes plut√¥t qu'√† des utilisateurs individuels</li>
                        <li>Appliquer le principe du moindre privil√®ge</li>
                        <li>Documenter toutes les d√©l√©gations</li>
                        <li>R√©viser r√©guli√®rement les d√©l√©gations</li>
                    </ul>
                </div>
            </div>

            <!-- Partie 5 -->
            <div class="section">
                <h2>üñ•Ô∏è 5. Gestion des Ordinateurs</h2>
                
                <h3>Joindre un ordinateur au domaine</h3>
                <p>L'int√©gration des postes de travail au domaine permet une gestion centralis√©e et l'application des GPO.</p>

                <div class="process-steps">
                    <div class="process-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Configurer le DNS</h4>
                            <p>S'assurer que le poste utilise le serveur DNS du contr√¥leur de domaine</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Acc√©der aux propri√©t√©s syst√®me</h4>
                            <p>Panneau de configuration ‚Üí Syst√®me ‚Üí Param√®tres syst√®me avanc√©s</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Joindre le domaine</h4>
                            <p>Onglet "Nom de l'ordinateur" ‚Üí Modifier ‚Üí Domaine ‚Üí Entrer le nom du domaine</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>S'authentifier</h4>
                            <p>Saisir les identifiants d'un compte autoris√© √† joindre des ordinateurs au domaine</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>Red√©marrer</h4>
                            <p>Red√©marrer l'ordinateur pour finaliser l'int√©gration</p>
                        </div>
                    </div>
                </div>

                <div class="example-box">
                    <h4>üí° Joindre un ordinateur via PowerShell</h4>
                    <div class="command-box">
                        <code>
# Joindre un ordinateur au domaine<br>
Add-Computer -DomainName "entreprise.local" `<br>
&nbsp;&nbsp;-Credential (Get-Credential) `<br>
&nbsp;&nbsp;-Restart<br><br>

# Joindre et placer dans une OU sp√©cifique<br>
Add-Computer -DomainName "entreprise.local" `<br>
&nbsp;&nbsp;-OUPath "OU=Postes_Comptabilite,DC=entreprise,DC=local" `<br>
&nbsp;&nbsp;-Credential (Get-Credential) `<br>
&nbsp;&nbsp;-Restart
                        </code>
                    </div>
                </div>

                <h3>Gestion des comptes ordinateurs</h3>
                <table>
                    <tr>
                        <th>Op√©ration</th>
                        <th>Commande PowerShell</th>
                        <th>Usage</th>
                    </tr>
                    <tr>
                        <td><strong>Lister les ordinateurs</strong></td>
                        <td>Get-ADComputer -Filter *</td>
                        <td>Inventaire du parc</td>
                    </tr>
                    <tr>
                        <td><strong>D√©sactiver un ordinateur</strong></td>
                        <td>Disable-ADAccount -Identity "PC-COMPTA-01"</td>
                        <td>Ordinateur hors service</td>
                    </tr>
                    <tr>
                        <td><strong>D√©placer un ordinateur</strong></td>
                        <td>Move-ADObject -Identity "CN=..." -TargetPath "OU=..."</td>
                        <td>R√©organisation</td>
                    </tr>
                    <tr>
                        <td><strong>Supprimer un ordinateur</strong></td>
                        <td>Remove-ADComputer -Identity "PC-COMPTA-01"</td>
                        <td>Ordinateur retir√© du parc</td>
                    </tr>
                    <tr>
                        <td><strong>R√©initialiser compte ordinateur</strong></td>
                        <td>Reset-ComputerMachinePassword</td>
                        <td>Probl√®me de relation d'approbation</td>
                    </tr>
                </table>

                <div class="highlight-box danger">
                    <strong>üîí S√©curit√© :</strong>
                    <p>Par d√©faut, les utilisateurs authentifi√©s peuvent joindre jusqu'√† 10 ordinateurs au domaine. Pour des raisons de s√©curit√©, il est recommand√© de :</p>
                    <ul>
                        <li>Limiter ce droit aux administrateurs uniquement</li>
                        <li>Pr√©-cr√©er les comptes ordinateurs dans l'AD</li>
                        <li>Utiliser des noms standardis√©s pour les postes</li>
                    </ul>
                </div>
            </div>

            <!-- Partie 6 -->
            <div class="section">
                <h2>üìÅ 6. Unit√©s d'Organisation (OU)</h2>
                
                <h3>Qu'est-ce qu'une OU ?</h3>
                <p>Les <strong>Unit√©s d'Organisation</strong> sont des conteneurs qui permettent d'organiser hi√©rarchiquement les objets AD (utilisateurs, groupes, ordinateurs) et de leur appliquer des GPO sp√©cifiques.</p>

                <div class="key-points">
                    <div class="key-point">
                        <h4>Organisation logique</h4>
                        <p>Structure selon les d√©partements, sites g√©ographiques ou fonctions de l'entreprise</p>
                    </div>
                    <div class="key-point">
                        <h4>Application de GPO</h4>
                        <p>Chaque OU peut avoir ses propres strat√©gies de groupe</p>
                    </div>
                    <div class="key-point">
                        <h4>D√©l√©gation cibl√©e</h4>
                        <p>Permet de d√©l√©guer l'administration par service ou d√©partement</p>
                    </div>
                </div>

                <div class="example-box">
                    <h4>üí° Exemple de structure OU</h4>
                    <div class="command-box">
                        <code>
entreprise.local<br>
‚îú‚îÄ‚îÄ Utilisateurs<br>
‚îÇ   ‚îú‚îÄ‚îÄ Direction<br>
‚îÇ   ‚îú‚îÄ‚îÄ Comptabilit√©<br>
‚îÇ   ‚îú‚îÄ‚îÄ RH<br>
‚îÇ   ‚îú‚îÄ‚îÄ IT<br>
‚îÇ   ‚îî‚îÄ‚îÄ Commercial<br>
‚îú‚îÄ‚îÄ Ordinateurs<br>
‚îÇ   ‚îú‚îÄ‚îÄ Postes_Direction<br>
‚îÇ   ‚îú‚îÄ‚îÄ Postes_Comptabilite<br>
‚îÇ   ‚îú‚îÄ‚îÄ Postes_RH<br>
‚îÇ   ‚îú‚îÄ‚îÄ Postes_IT<br>
‚îÇ   ‚îî‚îÄ‚îÄ Serveurs<br>
‚îú‚îÄ‚îÄ Groupes<br>
‚îÇ   ‚îú‚îÄ‚îÄ Securite<br>
‚îÇ   ‚îî‚îÄ‚îÄ Distribution<br>
‚îî‚îÄ‚îÄ Service_Accounts
                        </code>
                    </div>
                </div>

                <h3>Cr√©er et g√©rer des OU</h3>
                <div class="example-box">
                    <h4>üí° Gestion des OU en PowerShell</h4>
                    <div class="command-box">
                        <code>
# Cr√©er une OU<br>
New-ADOrganizationalUnit -Name "Comptabilit√©" `<br>
&nbsp;&nbsp;-Path "OU=Utilisateurs,DC=entreprise,DC=local" `<br>
&nbsp;&nbsp;-ProtectedFromAccidentalDeletion $true<br><br>

# Cr√©er une structure compl√®te<br>
New-ADOrganizationalUnit -Name "Paris" -Path "DC=entreprise,DC=local"<br>
New-ADOrganizationalUnit -Name "Utilisateurs" -Path "OU=Paris,DC=entreprise,DC=local"<br>
New-ADOrganizationalUnit -Name "Ordinateurs" -Path "OU=Paris,DC=entreprise,DC=local"<br><br>

# Supprimer une OU (retirer d'abord la protection)<br>
Set-ADOrganizationalUnit -Identity "OU=Comptabilit√©,OU=Utilisateurs,DC=entreprise,DC=local" `<br>
&nbsp;&nbsp;-ProtectedFromAccidentalDeletion $false<br>
Remove-ADOrganizationalUnit -Identity "OU=Comptabilit√©,OU=Utilisateurs,DC=entreprise,DC=local"
                        </code>
                    </div>
                </div>

                <div class="highlight-box success">
                    <strong>‚úÖ Bonnes pratiques pour les OU :</strong>
                    <ul>
                        <li>Cr√©er une structure simple et √©volutive</li>
                        <li>√âviter les hi√©rarchies trop profondes (maximum 3-4 niveaux)</li>
                        <li>Prot√©ger les OU contre la suppression accidentelle</li>
                        <li>Documenter l'objectif de chaque OU</li>
                        <li>Organiser par fonction plut√¥t que par localisation (sauf infrastructures multi-sites)</li>
                    </ul>
                </div>
            </div>

            <!-- Partie 7 -->
            <div class="section">
                <h2>üîç 7. Requ√™tes et Recherches dans AD</h2>
                
                <h3>Recherches courantes</h3>
                <p>Active Directory offre de puissantes capacit√©s de recherche pour retrouver rapidement des objets.</p>

                <div class="example-box">
                    <h4>üí° Recherches avec PowerShell</h4>
                    <div class="command-box">
                        <code>
# Rechercher un utilisateur par nom<br>
Get-ADUser -Filter "Name -like '*Dupont*'"<br><br>

# Rechercher les utilisateurs d'un service<br>
Get-ADUser -Filter "Department -eq 'Comptabilit√©'" -Properties Department<br><br>

# Utilisateurs avec mot de passe expir√©<br>
Search-ADAccount -PasswordExpired<br><br>

# Utilisateurs d√©sactiv√©s<br>
Get-ADUser -Filter "Enabled -eq '$false'"<br><br>

# Comptes inactifs depuis 90 jours<br>
$date = (Get-Date).AddDays(-90)<br>
Get-ADUser -Filter {LastLogonDate -lt $date} -Properties LastLogonDate<br><br>

# Ordinateurs par syst√®me d'exploitation<br>
Get-ADComputer -Filter * -Properties OperatingSystem | `<br>
&nbsp;&nbsp;Group-Object OperatingSystem | `<br>
&nbsp;&nbsp;Select-Object Name, Count<br><br>

# Membres d'un groupe<br>
Get-ADGroupMember -Identity "Domain Admins" -Recursive<br><br>

# Groupes dont un utilisateur est membre<br>
Get-ADUser -Identity jdupont -Properties MemberOf | `<br>
&nbsp;&nbsp;Select-Object -ExpandProperty MemberOf
                        </code>
                    </div>
                </div>

                <h3>Exporter des donn√©es</h3>
                <div class="example-box">
                    <h4>üí° Export vers CSV</h4>
                    <div class="command-box">
                        <code>
# Exporter tous les utilisateurs avec d√©tails<br>
Get-ADUser -Filter * -Properties * | `<br>
&nbsp;&nbsp;Select-Object Name, SamAccountName, EmailAddress, Department, Title | `<br>
&nbsp;&nbsp;Export-Csv -Path "C:\Export\Utilisateurs.csv" -NoTypeInformation -Encoding UTF8<br><br>

# Exporter les ordinateurs<br>
Get-ADComputer -Filter * -Properties * | `<br>
&nbsp;&nbsp;Select-Object Name, OperatingSystem, LastLogonDate, IPv4Address | `<br>
&nbsp;&nbsp;Export-Csv -Path "C:\Export\Ordinateurs.csv" -NoTypeInformation -Encoding UTF8<br><br>

# Exporter les groupes et leurs membres<br>
$groupes = Get-ADGroup -Filter *<br>
$resultats = foreach ($groupe in $groupes) {<br>
&nbsp;&nbsp;$membres = Get-ADGroupMember -Identity $groupe | Select-Object -ExpandProperty Name<br>
&nbsp;&nbsp;[PSCustomObject]@{<br>
&nbsp;&nbsp;&nbsp;&nbsp;Groupe = $groupe.Name<br>
&nbsp;&nbsp;&nbsp;&nbsp;Membres = $membres -join "; "<br>
&nbsp;&nbsp;}<br>
}<br>
$resultats | Export-Csv -Path "C:\Export\Groupes.csv" -NoTypeInformation -Encoding UTF8
                        </code>
                    </div>
                </div>
            </div>

            <!-- Partie 8 -->
            <div class="section">
                <h2>üõ°Ô∏è 8. S√©curit√© et Bonnes Pratiques</h2>
                
                <h3>Strat√©gie de mot de passe</h3>
                <p>Une politique stricte de mots de passe est essentielle pour la s√©curit√© du domaine.</p>

                <table>
                    <tr>
                        <th>Param√®tre</th>
                        <th>Recommandation</th>
                        <th>Emplacement GPO</th>
                    </tr>
                    <tr>
                        <td><strong>Longueur minimale</strong></td>
                        <td>12 caract√®res minimum</td>
                        <td>Strat√©gie de compte ‚Üí Strat√©gie de mot de passe</td>
                    </tr>
                    <tr>
                        <td><strong>Complexit√©</strong></td>
                        <td>Activ√©e (majuscules, minuscules, chiffres, symboles)</td>
                        <td>Strat√©gie de compte ‚Üí Strat√©gie de mot de passe</td>
                    </tr>
                    <tr>
                        <td><strong>Dur√©e de vie maximale</strong></td>
                        <td>90 jours</td>
                        <td>Strat√©gie de compte ‚Üí Strat√©gie de mot de passe</td>
                    </tr>
                    <tr>
                        <td><strong>Historique</strong></td>
                        <td>Conserver 24 mots de passe</td>
                        <td>Strat√©gie de compte ‚Üí Strat√©gie de mot de passe</td>
                    </tr>
                    <tr>
                        <td><strong>Seuil de verrouillage</strong></td>
                        <td>5 tentatives invalides</td>
                        <td>Strat√©gie de compte ‚Üí Strat√©gie de verrouillage</td>
                    </tr>
                </table>

                <h3>Strat√©gies de s√©curit√© essentielles</h3>
                <div class="key-points">
                    <div class="key-point">
                        <h4>Principe du moindre privil√®ge</h4>
                        <p>N'accorder que les droits strictement n√©cessaires. √âviter d'ajouter des utilisateurs aux "Domain Admins" sauf absolue n√©cessit√©.</p>
                    </div>
                    <div class="key-point">
                        <h4>Comptes de service</h4>
                        <p>Utiliser des comptes d√©di√©s pour les services, avec mots de passe complexes et non expirables.</p>
                    </div>
                    <div class="key-point">
                        <h4>Audit et logs</h4>
                        <p>Activer l'audit des √©v√©nements critiques (connexions, modifications AD, changements de permissions).</p>
                    </div>
                    <div class="key-point">
                        <h4>Sauvegardes r√©guli√®res</h4>
                        <p>Sauvegarder l'AD r√©guli√®rement (System State) et tester les restaurations.</p>
                    </div>
                </div>

                <div class="highlight-box danger">
                    <strong>‚õî Erreurs courantes √† √©viter :</strong>
                    <ul>
                        <li>Utiliser le compte Administrateur pour les t√¢ches quotidiennes</li>
                        <li>Ne pas documenter les modifications apport√©es √† l'AD</li>
                        <li>Appliquer des GPO au niveau du domaine plut√¥t qu'aux OU</li>
                        <li>Ne pas tester les GPO avant d√©ploiement en production</li>
                        <li>Ignorer les comptes inactifs et obsol√®tes</li>
                        <li>Ne pas surveiller les logs d'√©v√©nements du contr√¥leur de domaine</li>
                    </ul>
                </div>

                <h3>Maintenance r√©guli√®re</h3>
                <div class="process-steps">
                    <div class="process-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Audit mensuel</h4>
                            <p>V√©rifier les comptes inactifs, les groupes vides, les GPO non li√©es</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Nettoyage trimestriel</h4>
                            <p>Supprimer les comptes obsol√®tes, r√©organiser les OU si n√©cessaire</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Revue semestrielle</h4>
                            <p>Auditer les droits administratifs, r√©viser les d√©l√©gations, v√©rifier les r√¥les FSMO</p>
                        </div>
                    </div>

                    <div class="process-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Sauvegardes quotidiennes</h4>
                            <p>Automatiser les sauvegardes du System State et tester r√©guli√®rement les restaurations</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quiz -->
            <div class="quiz-section">
                <h2>üìù Questions de R√©vision</h2>
                
                <div class="section">
                    <h3>Question 1</h3>
                    <p><strong>Quelle commande PowerShell permet de forcer l'application imm√©diate des GPO sur un poste ?</strong></p>
                    <div class="highlight-box">
                        <strong>R√©ponse :</strong> <code>gpupdate /force</code>
                    </div>
                </div>

                <div class="section">
                    <h3>Question 2</h3>
                    <p><strong>Quel est le r√¥le FSMO responsable de la synchronisation horaire et de l'authentification prioritaire ?</strong></p>
                    <div class="highlight-box">
                        <strong>R√©ponse :</strong> L'√©mulateur PDC (Primary Domain Controller)
                    </div>
                </div>

                <div class="section">
                    <h3>Question 3</h3>
                    <p><strong>Quelle est la diff√©rence entre un groupe de s√©curit√© et un groupe de distribution ?</strong></p>
                    <div class="highlight-box">
                        <strong>R√©ponse :</strong> Un groupe de s√©curit√© permet d'attribuer des permissions sur des ressources, tandis qu'un groupe de distribution sert uniquement pour les listes de diffusion e-mail (Exchange).
                    </div>
                </div>

                <div class="section">
                    <h3>Question 4</h3>
                    <p><strong>Dans quel ordre sont appliqu√©es les GPO ?</strong></p>
                    <div class="highlight-box">
                        <strong>R√©ponse :</strong> Local ‚Üí Site ‚Üí Domaine ‚Üí OU (les GPO des OU ont la priorit√© la plus haute)
                    </div>
                </div>

                <div class="section">
                    <h3>Question 5</h3>
                    <p><strong>Comment rechercher tous les utilisateurs dont le compte est d√©sactiv√© ?</strong></p>
                    <div class="highlight-box">
                        <strong>R√©ponse :</strong> <code>Get-ADUser -Filter "Enabled -eq '$false'"</code>
                    </div>
                </div>
            </div>

            <!-- Conclusion -->
            <div class="section">
                <h2>üéØ Conclusion</h2>
                <p>La ma√Ætrise d'Active Directory est une comp√©tence fondamentale pour tout technicien d'assistance informatique. Ce cours vous a pr√©sent√© les op√©rations essentielles :</p>
                
                <div class="key-points">
                    <div class="key-point">
                        <h4>Gestion quotidienne</h4>
                        <p>Cr√©ation et modification d'utilisateurs, gestion des groupes, support aux utilisateurs</p>
                    </div>
                    <div class="key-point">
                        <h4>D√©ploiement</h4>
                        <p>Application de strat√©gies de groupe, int√©gration de postes au domaine</p>
                    </div>
                    <div class="key-point">
                        <h4>Administration avanc√©e</h4>
                        <p>D√©l√©gation, gestion des OU, surveillance et maintenance</p>
                    </div>
                    <div class="key-point">
                        <h4>S√©curit√©</h4>
                        <p>Application des bonnes pratiques, audit r√©gulier, principe du moindre privil√®ge</p>
                    </div>
                </div>

                <div class="highlight-box success">
                    <strong>üí° Conseils pour progresser :</strong>
                    <ul>
                        <li>Pratiquez r√©guli√®rement dans un environnement de test</li>
                        <li>Automatisez les t√¢ches r√©p√©titives avec PowerShell</li>
                        <li>Documentez vos interventions et cr√©ez vos propres proc√©dures</li>
                        <li>Restez inform√© des √©volutions d'Active Directory et des nouvelles menaces de s√©curit√©</li>
                        <li>Consultez la documentation Microsoft officielle pour approfondir vos connaissances</li>
                    </ul>
                </div>

                <p style="text-align: center; margin-top: 2rem; font-size: 1.1rem; color: #3B5BDB;">
                                    </p>
            </div>

        </div>
    </div>

    <footer>
        <p>&copy; 2025 Formation TAI - Intervenir sur un annuaire Active Directory</p>
        <p>CCP 3 - Intervenir sur les √âl√©ments de l'Infrastructure</p>
                        </div>
